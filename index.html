<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>파이썬 방탈출 게임</title>
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      line-height: 1.6;
      padding: 16px;
      max-width: 900px;
      margin: 0 auto;
    }
    h1, h2, h3 {
      margin-top: 1.4em;
    }
    .chapter {
      border: 1px solid #ccc;
      padding: 12px 16px;
      margin-bottom: 20px;
      border-radius: 8px;
    }
    .stage {
      border-top: 1px dashed #ddd;
      padding-top: 10px;
      margin-top: 10px;
    }
    .code {
      background: #f5f5f5;
      padding: 8px 10px;
      border-radius: 4px;
      font-family: "JetBrains Mono", "Consolas", monospace;
      white-space: pre-wrap;
    }
    .hint-buttons {
      margin-top: 8px;
    }
    .hint-box, .answer-box {
      margin-top: 6px;
      font-size: 0.95rem;
    }
    .result {
      margin-top: 12px;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h1>파이썬 방탈출 게임 🎮</h1>
  <p>
    수업이 끝난 뒤, 이 페이지를 보면서 <strong>파이썬(Jupyter) 수업 내용을 복습</strong>해 보세요.<br>
    각 챕터는 원하는 만큼 다시 실행하면서 즐겨도 됩니다.
  </p>

  <hr>

  <!-- ===================== 챕터 1: 스트리밍 ===================== -->
  <div class="chapter" id="chapter1">
    <h2>📙 챕터 1. 아이돌 스트리밍 차트 분석</h2>
    <p>
      너는 이제 <strong>신인 아이돌 그룹의 멤버</strong>입니다.<br>
      우리 그룹의 노래가 얼마나 사랑받고 있는지, <strong>데이터와 그래프</strong>로 확인해보세요!<br>
    </p>

    <!-- 공통 데이터 코드 (설명용) -->
    <div class="code">
import pandas as pd
import matplotlib.pyplot as plt

data = {
    "day": ["월", "화", "수", "목", "금", "토", "일"] * 2,
    "song": ["TITLE"] * 7 + ["B-SIDE"] * 7,
    "streams": [100, 150, 180, 200, 300, 350, 400,
                80, 90, 120, 130, 160, 170, 200]
}

df = pd.DataFrame(data)
print(df.head())
    </div>

    <!-- Stage 1 -->
    <div class="stage">
      <h3>Stage 1. 일별 스트리밍 그래프 그리기</h3>

      <!-- 1-1: 정답 맞히면 그래프 표시 -->
      <div class="question" id="q1_1"
           data-type="short"
           data-answer="day"
           data-hint1="그래프의 x축에는 '요일' 정보가 들어가요."
           data-hint2="코드에서 x축으로 사용하는 열 이름은 day 입니다.">
        <p><strong>[1-1]</strong>  
          <strong>코드를 따라 데이터 입력하기</strong><br>
          TITLE 곡의 일별 스트리밍 그래프를 그릴 때,<br>
          <strong>x축에 사용할 열 이름(영문)</strong>을 적어보세요.
        </p>
        <input type="text" />

        <div class="hint-buttons">
          <button type="button" class="hint-btn" data-hint="1">힌트 1 보기</button>
          <button type="button" class="hint-btn" data-hint="2">힌트 2 보기</button>
          <button type="button" class="answer-btn">정답 보기</button>
        </div>
        <div class="hint-box"></div>
        <div class="answer-box"></div>
      </div>

      <!-- 그래프 영역 (정답 맞으면 표시) -->
      <div id="graph1_box" style="display:none; margin-top:12px;">
        <canvas id="graph1_canvas" width="500" height="250"></canvas>
      </div>
    </div>

    <!-- Stage 1-2: TITLE 필터링 -->
    <div class="stage">
      <h3>Stage 1-2. TITLE 곡만 선택하기</h3>
      <div class="question"
           data-type="short"
           data-answer="df[df['song']=='TITLE']|df[df['song'] == 'TITLE']|df_title=df[df['song']=='TITLE']|df_title = df[df['song']=='TITLE']"
           data-hint1="df에서 song 열이 'TITLE'인 행만 골라서 사용합니다. 예: df[ df['song'] == 'TITLE' ]"
           data-hint2="예시 코드:
df_title = df[df['song'] == 'TITLE']">
        <p><strong>[1-2]</strong>  
          TITLE 곡만 선택해서 새로운 데이터프레임 <code>df_title</code>에 담는 코드를 적어보세요.
        </p>
        <input type="text" />

        <div class="hint-buttons">
          <button type="button" class="hint-btn" data-hint="1">힌트 1 보기</button>
          <button type="button" class="hint-btn" data-hint="2">힌트 2 보기</button>
          <button type="button" class="answer-btn">정답 보기</button>
        </div>
        <div class="hint-box"></div>
        <div class="answer-box"></div>
      </div>
    </div>

    <!-- Stage 2 -->
    <div class="stage">
      <h3>Stage 2. 같은 데이터끼리 묶어보기 (요일별 합계 & 막대그래프)</h3>

      <!-- 2-1 요일별 합계 -->
      <div class="question"
           data-type="short"
           data-answer="df.groupby('day')['streams'].sum()|streams_by_day=df.groupby('day')['streams'].sum()|streams_by_day = df.groupby('day')['streams'].sum()"
           data-hint1="groupby 함수를 사용해 'day' 기준으로 묶고, 'streams' 열에 sum()을 적용합니다."
           data-hint2="예시 코드:
streams_by_day = df.groupby('day')['streams'].sum()">
        <p><strong>[2-1]</strong>  
          요일(<code>day</code>)별 스트리밍 합계를 구하는 코드를 적어보세요.
        </p>
        <input type="text" />

        <div class="hint-buttons">
          <button type="button" class="hint-btn" data-hint="1">힌트 1 보기</button>
          <button type="button" class="hint-btn" data-hint="2">힌트 2 보기</button>
          <button type="button" class="answer-btn">정답 보기</button>
        </div>
        <div class="hint-box"></div>
        <div class="answer-box"></div>
      </div>

      <!-- 2-2 막대 그래프 -->
      <div class="question"
           data-type="short"
           data-answer="streams_by_day.plot(kind='bar')"
           data-hint1="pandas의 plot 함수에 kind='bar'를 주면 막대그래프를 그릴 수 있어요."
           data-hint2="예시 코드:
streams_by_day.plot(kind='bar')">
        <p><strong>[2-2]</strong>  
          <code>streams_by_day</code> 데이터를 이용해 <strong>막대 그래프</strong>를 그리는 코드를 적어보세요.
        </p>
        <input type="text" />

        <div class="hint-buttons">
          <button type="button" class="hint-btn" data-hint="1">힌트 1 보기</button>
          <button type="button" class="hint-btn" data-hint="2">힌트 2 보기</button>
          <button type="button" class="answer-btn">정답 보기</button>
        </div>
        <div class="hint-box"></div>
        <div class="answer-box"></div>
      </div>
    </div>

    <!-- Stage 3 -->
    <div class="stage">
      <h3>Stage 3. 자동 차트 생성 버튼 만들기 (함수 만들기)</h3>

      <div class="question"
           data-type="text"
           data-answer="def plot_song(df, song_name):"
           data-hint1="함수 안에서 song_name으로 행을 필터링하고, plt.plot으로 day와 streams를 그립니다."
           data-hint2="예시 코드:
def plot_song(df, song_name):
    song_df = df[df['song'] == song_name]
    plt.plot(song_df['day'], song_df['streams'])
    plt.title(f'{song_name} 일별 스트리밍')
    plt.xlabel('요일')
    plt.ylabel('스트리밍 수')
    plt.show()">
        <p><strong>[3-1]</strong>  
          노래 이름(<code>song_name</code>)을 넣으면 자동으로 그 노래의 일별 스트리밍 그래프를 그려주는 함수를 만들어 보세요.
        </p>
        <textarea rows="4"></textarea>

        <div class="hint-buttons">
          <button type="button" class="hint-btn" data-hint="1">힌트 1 보기</button>
          <button type="button" class="hint-btn" data-hint="2">힌트 2 보기</button>
          <button type="button" class="answer-btn">정답 보기</button>
        </div>
        <div class="hint-box"></div>
        <div class="answer-box"></div>
      </div>
    </div>

    <div class="result" id="chapter1_result"></div>
  </div>

  <!-- ===================== 챕터 2: 뇌섹남: 파이썬 ===================== -->
  <div class="chapter" id="chapter2">
    <h2>📘 챕터 2. 예능 스케줄: 「뇌섹남: 파이썬」 </h2>
    <p>
      컴백을 앞둔 당신(아이돌 멤버)은 컴백 홍보를 위해 한 예능 프로그램에 나가게 되었습니다.<br>
      데뷔 초 인터뷰에서 밝혔던 당신의 관심사, 바로 <strong>'AI'</strong>와 <strong>'코딩'</strong>!<br>
      매니저가 이번에 잡아온 스케줄은 바로 <strong>「뇌섹남: 파이썬」 편</strong>입니다.<br>
      이제 방송에서 당신의 파이썬 실력을 보여주세요! 🔐
    </p>

    <!-- Stage 2 -->
    <div class="stage">
      <h3>Stage 2 — 정규식 퍼즐 🔍</h3>

      <p><strong>[2-1]</strong>  
        아래 문장에서 <strong>정규식을 사용해 숫자 2025를 찾는 코드</strong>를 적어보세요.
      </p>

      <div class="code">
import re
text = "탈출코드는 2025년에 공개된다!"
      </div>

      <div class="question"
        data-type="short"
        data-answer="re.findall(r'\\d+',text)|re.findall(r'\\d+', text)|re.search(r'\\d+',text).group()|re.search(r'\\d+', text).group()"
        data-hint1="정규식에서 숫자를 찾을 때는 \\d+ 패턴을 사용합니다."
        data-hint2="예시 코드:
re.findall(r'\\d+', text)">
        
        <input type="text" />

        <div class="hint-buttons">
          <button class="hint-btn" data-hint="1" type="button">힌트 1 보기</button>
          <button class="hint-btn" data-hint="2" type="button">힌트 2 보기</button>
          <button class="answer-btn" type="button">정답 보기</button>
        </div>

        <div class="hint-box"></div>
        <div class="answer-box"></div>
      </div>
    </div>


    <!-- Stage 3 -->
    <div class="stage">
      <h3>Stage 3 — 배열 조각 퍼즐 🧮</h3>

      <p><strong>[3-1]</strong>  
        아래 배열 <code>[2, 4, 6]</code>의 값을 <strong>모두 곱하는 코드</strong>를 적어보세요.
      </p>

      <div class="code">
import numpy as np
arr = np.array([2, 4, 6])
      </div>

      <div class="question"
        data-type="short"
        data-answer="2*4*6|arr.prod()|np.prod(arr)"
        data-hint1="배열의 원소를 모두 곱할 때는 np.prod(arr)를 사용할 수도 있어요."
        data-hint2="예시 코드:
np.prod(arr)">
        
        <input type="text" />

        <div class="hint-buttons">
          <button class="hint-btn" data-hint="1" type="button">힌트 1 보기</button>
          <button class="hint-btn" data-hint="2" type="button">힌트 2 보기</button>
          <button class="answer-btn" type="button">정답 보기</button>
        </div>

        <div class="hint-box"></div>
        <div class="answer-box"></div>
      </div>
    </div>


    <!-- Stage 4 -->
    <div class="stage">
      <h3>Stage 4 — 인덱싱 / 슬라이싱 ✂</h3>

      <!-- 4-1 -->
      <div class="question"
        data-type="short"
        data-answer="word[1]"
        data-hint1="파이썬은 0부터 시작해요. 두 번째 글자 = 인덱스 1"
        data-hint2="예시 코드:
word[1]">

        <p><strong>[4-1]</strong>  
          문자열 <code>word = "HELLO"</code> 에서  
          <strong>두 번째 글자</strong>를 꺼내는 코드를 적어보세요.
        </p>

        <input type="text" />

        <div class="hint-buttons">
          <button class="hint-btn" data-hint="1" type="button">힌트 1 보기</button>
          <button class="hint-btn" data-hint="2" type="button">힌트 2 보기</button>
          <button class="answer-btn" type="button">정답 보기</button>
        </div>

        <div class="hint-box"></div>
        <div class="answer-box"></div>
      </div>


      <!-- 4-2 -->
      <div class="question"
        data-type="short"
        data-answer="text[5:9]|text[5: ]|text[5:]"
        data-hint1="'ROOM'은 인덱스 5부터 시작해요."
        data-hint2="예시 코드:
text[5:9]">

        <p><strong>[4-2]</strong>  
          문자열 <code>text = "ESCAPEROOM"</code> 에서  
          <strong>"ROOM"</strong>을 꺼내는 코드를 적어보세요.
        </p>

        <input type="text" />

        <div class="hint-buttons">
          <button class="hint-btn" data-hint="1" type="button">힌트 1 보기</button>
          <button class="hint-btn" data-hint="2" type="button">힌트 2 보기</button>
          <button class="answer-btn" type="button">정답 보기</button>
        </div>

        <div class="hint-box"></div>
        <div class="answer-box"></div>
      </div>
    </div>

    <button onclick="checkChapter('chapter2')" type="button">챕터 2 점수 확인하기</button>
    <div class="result" id="chapter2_result"></div>
  </div>


  <!-- ===================== SCRIPT ===================== -->
  <script>
    // 간단한 그래프 그리기 (Stage 1-1 정답일 때)
    function drawGraph1() {
      const canvas = document.getElementById("graph1_canvas");
      if (!canvas) return;
      const ctx = canvas.getContext("2d");
      const days = ["월","화","수","목","금","토","일"];
      const streams = [100,150,180,200,300,350,400];

      ctx.clearRect(0, 0, canvas.width, canvas.height);

      const marginLeft = 40;
      const marginBottom = 30;
      const width = canvas.width;
      const height = canvas.height;
      const graphWidth = width - marginLeft - 10;
      const graphHeight = height - marginBottom - 20;

      // 축
      ctx.strokeStyle = "#333";
      ctx.beginPath();
      ctx.moveTo(marginLeft, 10);
      ctx.lineTo(marginLeft, 10 + graphHeight);
      ctx.lineTo(marginLeft + graphWidth, 10 + graphHeight);
      ctx.stroke();

      const maxVal = Math.max(...streams);
      const stepX = graphWidth / (days.length - 1);

      // 라인
      ctx.strokeStyle = "#1976d2";
      ctx.fillStyle = "#1976d2";
      ctx.beginPath();
      streams.forEach((v, i) => {
        const x = marginLeft + stepX * i;
        const y = 10 + graphHeight - (v / maxVal) * graphHeight;
        if (i === 0) ctx.moveTo(x, y);
        else ctx.lineTo(x, y);
      });
      ctx.stroke();

      // 점
      streams.forEach((v, i) => {
        const x = marginLeft + stepX * i;
        const y = 10 + graphHeight - (v / maxVal) * graphHeight;
        ctx.beginPath();
        ctx.arc(x, y, 3, 0, Math.PI * 2);
        ctx.fill();
      });

      // x축 라벨
      ctx.fillStyle = "#000";
      ctx.font = "12px sans-serif";
      days.forEach((d, i) => {
        const x = marginLeft + stepX * i;
        const y = 10 + graphHeight + 15;
        ctx.fillText(d, x - 8, y);
      });

      // 제목
      ctx.font = "14px sans-serif";
      ctx.fillText("TITLE 일별 스트리밍 (예시 그래프)", marginLeft, 20);
    }

    // 힌트 및 정답 보기 버튼 기능 + 1-1 자동 그래프
    document.addEventListener("DOMContentLoaded", function () {
      const questions = document.querySelectorAll(".question");

      questions.forEach(q => {
        const hintBox = q.querySelector(".hint-box");
        const answerBox = q.querySelector(".answer-box");

        // 힌트 버튼
        const hintButtons = q.querySelectorAll(".hint-btn");
        hintButtons.forEach(btn => {
          btn.addEventListener("click", function () {
            const idx = btn.getAttribute("data-hint");
            // 힌트 2는 힌트 1 사용 후에만
            if (idx === "2") {
              const firstHintBtn = q.querySelector('.hint-btn[data-hint="1"]');
              if (!firstHintBtn || !firstHintBtn.classList.contains("used")) {
                if (hintBox) hintBox.textContent = "먼저 힌트 1을 확인해 보세요.";
                return;
              }
            }
            const hintText = q.getAttribute("data-hint" + idx);
            if (hintBox) hintBox.textContent = hintText || "";
            btn.classList.add("used");
          });
        });

        // 정답 버튼
        const answerBtn = q.querySelector(".answer-btn");
        if (answerBtn) {
          answerBtn.addEventListener("click", function () {
            const ansAttr = q.getAttribute("data-answer");
            if (!ansAttr) return;
            const firstAnswer = ansAttr.split("|")[0];
            if (answerBox) answerBox.textContent = "정답: " + firstAnswer;
            answerBtn.classList.add("used");
          });
        }
      });

      // Stage 1-1: 입력 중에 자동으로 그래프 표시
      const q11 = document.getElementById("q1_1");
      if (q11) {
        const input = q11.querySelector('input[type="text"]');
        const ansAttr = q11.getAttribute("data-answer");
        if (input && ansAttr) {
          const answers = ansAttr
            .split("|")
            .map(a => a.trim().replace(/\\s+/g, "").toLowerCase());
          input.addEventListener("input", function () {
            const user = (input.value || "").trim().replace(/\\s+/g, "").toLowerCase();
            const box = document.getElementById("graph1_box");
            if (!box) return;
            if (answers.includes(user)) {
              box.style.display = "block";
              drawGraph1();
            } else {
              box.style.display = "none";
            }
          });
        }
      }
    });

    // 챕터 채점 기능 (chapter2용)
    function checkChapter(chapterId) {
      const chapter = document.getElementById(chapterId);
      const questions = chapter.querySelectorAll('.question');
      let total = 0;
      let correct = 0;

      questions.forEach(q => {
        const type = q.getAttribute('data-type');
        const answerAttr = q.getAttribute('data-answer');
        if (!answerAttr || type !== 'short') return;

        const answers = answerAttr.split("|").map(a => a.trim().replace(/\\s+/g, "").toLowerCase());
        const input = q.querySelector('input[type="text"], textarea');
        if (!input) return;

        const userRaw = (input.value || "").trim();
        const user = userRaw.replace(/\\s+/g, "").toLowerCase();

        total += 1;
        if (answers.includes(user)) {
          correct += 1;
        }
      });

      const resultEl = document.getElementById(chapterId + "_result");
      resultEl.textContent = `정답: ${correct} / ${total} 문제`;
    }
  </script>
</body>
</html>
